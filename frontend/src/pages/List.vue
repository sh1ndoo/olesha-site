<template>
  <h1 style="text-align: center; font-size: 2.5rem; margin-bottom: 1rem">Список Аукционов</h1>
  <div class="description">
    <div class="quote">
      <div class="quote-left">
        <i class="fa-solid fa-exclamation"></i>
      </div>
      <p>Всё перечисленное ниже не допускается к следующим аукционам</p>
    </div>
  </div>
  <div class="main-container">
    <!-- Блоки поиска и выбора типа остаются без изменений -->
    <div class="search">
      <input
          type="text"
          v-model="searchQuery"
          placeholder="Поиск по таблице..."
      />
    </div>

    <div class="type">
      <button
          v-for="typeKey in Object.keys(fakeApi)"
          :key="typeKey"
          :class="{ active: activeType === typeKey }"
          @click="changeType(typeKey)"
          class="type-btn"
      >
        {{ typeKey }}
      </button>
    </div>

    <!-- БЛОК ОТОБРАЖЕНИЯ - ТЕПЕРЬ С ТАБЛИЦЕЙ -->
    <div class="list">
      <div v-if="loading" class="state-indicator loading-state">
        <div class="spinner"></div>
        <p>Загрузка данных...</p>
      </div>

      <div v-else-if="error" class="state-indicator error-state">
        <p>Не удалось загрузить данные.</p>
        <p class="error-message">{{ error }}</p>
        <button @click="fetchData" class="retry-btn">Попробовать снова</button>
      </div>

      <!-- Отображаем таблицу, только если нет загрузки/ошибки -->
      <div v-else class="table-container">
          <table v-if="filteredList.length > 0">
            <thead>
            <tr>
              <!-- 1. Динамически создаем заголовки -->
              <th v-for="header in tableHeaders" :key="header">
                {{ header }}
              </th>
            </tr>
            </thead>
            <TransitionGroup name="list" tag="tbody">
              <tr v-for="item in filteredList" :key="item.название" :style="{ transitionDelay: item.номер < 15 ? `${item.номер * 20}ms` : '0ms' }">
                <td v-for="header in tableHeaders" :key="header">
                  {{ item[header] }}
                </td>
              </tr>
            </TransitionGroup>
          </table>
        </div>

        <!-- Показываем сообщение, если после фильтрации или загрузки данных нет -->
        <Transition name="fade">
          <div v-if="filteredList.length === 0" class="empty-state">
            <p>Ничего не найдено</p>
          </div>
        </Transition>
      </div>
    </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';
import Fuse from 'fuse.js';
// --- ИМИТАЦИЯ API (без изменений) ---
const fakeApiDatabase = {
  Игры: [
    {
      "Аукцион": "Игроаук",
      "номер": 1,
      "название": "Transistor",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 2,
      "название": "The Evil Within",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "88%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 3,
      "название": "Just Dance",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 4,
      "название": "Worms 3d",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "85%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 5,
      "название": "Freddi Fish 5",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "94%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 6,
      "название": "The Witcher",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "89%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 7,
      "название": "METRO: EXODUS",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "90%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 8,
      "название": "osu!",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 9,
      "название": "OFF: The Game",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 10,
      "название": "Stardew Valley",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "98%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 11,
      "название": "Cyberpunk 2077",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "83%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 12,
      "название": "The Life and Suffering of Sir Brante",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 13,
      "название": "Deep Rock Galactic",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 14,
      "название": "Freddi Fish 2",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "94%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 15,
      "название": "ULTRAKILL",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "98%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 16,
      "название": "Lobotomy Corp",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 17,
      "название": "Freddi Fish 1",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "93%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 18,
      "название": "Fear & Hunger",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "93%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 19,
      "название": "Who's Lila?",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 20,
      "название": "Rusty Lake Hotel",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 21,
      "название": "HELLDIVERS 2",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "72%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 22,
      "название": "Warhammer 40,000: Space Marine",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "94%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 23,
      "название": "OneShot",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "98%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 24,
      "название": "Antichamber",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 25,
      "название": "No More Heroes",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "90%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 26,
      "название": "Castle Crashers",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 27,
      "название": "The Wolf Among Us",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 28,
      "название": "Barotrauma",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "93%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 29,
      "название": "The Hex",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 30,
      "название": "Bloons TD 6",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 31,
      "название": "Psychopomp",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "92%"
    },
    {
      "Аукцион": "Игроаук",
      "номер": 32,
      "название": "Pizza Tower",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "98%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 1,
      "название": "Doki Doki Literature Club!",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 2,
      "название": "Dota 2",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "82%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 3,
      "название": "Genshin Impact",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 4,
      "название": "South Park: The Stick of Truth",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 5,
      "название": "Overwatch",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 6,
      "название": "I Wanna Be The Boshy",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "92%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 7,
      "название": "Cruelty Squad",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 8,
      "название": "Freddi Fish 4",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 9,
      "название": "OMORI",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "98%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 10,
      "название": "Freddi Fish 3",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 11,
      "название": "Fran Bow",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 12,
      "название": "Disco Elysium",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 13,
      "название": "Roblox",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 14,
      "название": "Fall Guys",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 15,
      "название": "Outer Wilds",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 16,
      "название": "SCP: Containment Breach",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "92%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 17,
      "название": "Rain World",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "94%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 18,
      "название": "Spore",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "93%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 19,
      "название": "Terraria",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 20,
      "название": "Fear & Hunger 2: Termina",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 21,
      "название": "The Cat Lady",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 22,
      "название": "Atomic Heart",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "86%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 23,
      "название": "The Hobbit",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 24,
      "название": "The Sims 4",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "87%"
    },
    {
      "Аукцион": "Прикольный",
      "номер": 25,
      "название": "Baldur's Gate 3",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Модный",
      "номер": 1,
      "Режим": "Реролл",
      "название": "Реролл | Minecraft",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "Нет в Steam"
    },
    {
      "Аукцион": "Модный",
      "номер": 3,
      "Режим": "Реролл",
      "название": "Реролл | Ace Attorney",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "97%"
    },
    {
      "Аукцион": "Модный",
      "номер": 4,
      "Режим": "Реролл",
      "название": "Реролл | Orwell",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "93%"
    },
    {
      "Аукцион": "Модный",
      "номер": 6,
      "Режим": "Демокр",
      "название": "Демокр | TF 2",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Модный",
      "номер": 7,
      "Режим": "Реролл",
      "название": "Реролл | 5D шахматы (краска)",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Модный",
      "номер": 9,
      "Режим": "Царь Горы",
      "название": "Царь Горы | Cities Skylines 2",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "57%"
    },
    {
      "Аукцион": "Модный",
      "номер": 10,
      "Режим": "Абсурдный",
      "название": "Абсурдный | Скайрим + Куплинов ЛП",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "95%"
    },
    {
      "Аукцион": "Фулл",
      "номер": 1,
      "название": "Sleeping Dogs",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "96%"
    },
    {
      "Аукцион": "Фулл",
      "номер": 2,
      "название": "Portal 2",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "98%"
    },
    {
      "Аукцион": "Фулл",
      "номер": 3,
      "название": "The Banner Saga",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "91%"
    },
    {
      "Аукцион": "Фулл",
      "номер": 4,
      "название": "I Wanna Be The Boshy ",
      "просмотр": "Отсутствует",
      "оценка стримера": "Неизвестно",
      "Отзывы в Steam": "92%"
    }
  ],
    Кино: [
      {
        "Аукцион": "Киноаук",
        "номер": 1,
        "название": "Кто я",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 2,
        "название": "Суперхирург",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 3,
        "название": "Миньоны: Гравютация",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.5/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 4,
        "название": "Нечто",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 5,
        "название": "Сумерки",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 6,
        "название": "My Little Pony: The Movie",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 6,
        "название": "My Little Pony: A New Generation",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 6,
        "название": "Игра",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 7,
        "название": "Кот в сапогах 2",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 7,
        "название": "9",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 8,
        "название": "Драйв",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 8,
        "название": "Игра на понижение",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 9,
        "название": "Лило и Стич",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 9,
        "название": "МЛП: Эквестрия",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 10,
        "название": "Маяк",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 10,
        "название": "Парк Юрского Периода",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 11,
        "название": "Страх и ненависть в ЛВ",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 11,
        "название": "Финес и Фёрб",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 11,
        "название": "Падшие Ангелы",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 12,
        "название": "Коралина",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 12,
        "название": "Подземелья и драконы",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 13,
        "название": "Клоунада",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 13,
        "название": "D: Жажда крови",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 14,
        "название": "FF7",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 14,
        "название": "Emesis Blue",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 15,
        "название": "Бейскетболл",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 15,
        "название": "Реальные Упыри",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 16,
        "название": "Последняя дуэль",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 16,
        "название": "Богемская Рапсодия",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.9/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 17,
        "название": "Дом странных детей Перегрин",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 17,
        "название": "Врунгель",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 18,
        "название": "Царство грез и безумия",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 18,
        "название": "Проза бр псов",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 19,
        "название": "Клаус",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 19,
        "название": "Рождественская история",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 20,
        "название": "Месть от кутюр",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 20,
        "название": "Мост в Терабитию",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 21,
        "название": "Они клонировали Тайрона",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 21,
        "название": "Последнее Путешествие Деметра",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 22,
        "название": "Везучий случай",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 23,
        "название": "Отель «Гранд-Будапешт»",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 23,
        "название": "Одноклассники",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.9/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 24,
        "название": "Наводнение",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.9/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 24,
        "название": "Мама",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 25,
        "название": "Five Nights at Freddy's",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.5/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 25,
        "название": "Заклятье: Инкарнация",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "4.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 26,
        "название": "Бизнес по казахски",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 26,
        "название": "Американ Психо",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 27,
        "название": "Человек Паук: Паутина Вселенных",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 28,
        "название": "Смешарики: Начало",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 29,
        "название": "Тело Джениффер",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 30,
        "название": "ПБП: Зверь",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.9/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 30,
        "название": "Падение Империи",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 31,
        "название": "12 разгневанных мужчин",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "9.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 32,
        "название": "Крепкий орешек",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 33,
        "название": "Смертельный оргазм",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 34,
        "название": "Хижина в Лесу",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 34,
        "название": "Чёрный Динамит",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 35,
        "название": "Список Шиндлера",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "9.0/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 36,
        "название": "Птичий Короб",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 36,
        "название": "Большой Куш",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 37,
        "название": "Лего Фильм",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 37,
        "название": "Мягкие и Спокойные",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 38,
        "название": "Земля против Паука",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "4.9/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 38,
        "название": "Всё везде и сразу",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 39,
        "название": "Россия. Кремль. Путин.",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "1.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 39,
        "название": "Гремлины",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 40,
        "название": "Шина",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "5.7/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 40,
        "название": "Пила",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 41,
        "название": "Начало",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.8/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 42,
        "название": "Соник 3",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "Неизвестно"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 42,
        "название": "Пила 2",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 43,
        "название": "Быстрее Пули",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.3/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 44,
        "название": "Minecraft Movie",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "Неизвестно"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 45,
        "название": "Тайна Коко",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 45,
        "название": "Голодные Игры",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.2/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 46,
        "название": "1+1",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "8.5/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 46,
        "название": "Мгла",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.1/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 47,
        "название": "Трансформеры: Начало",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "Неизвестно"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 48,
        "название": "Зависнуть в Палм Спрингс",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "7.4/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 48,
        "название": "Звёздные Войны: Скрытая угроза",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.5/10"
      },
      {
        "Аукцион": "Киноаук",
        "номер": 49,
        "название": "Звёздные Войны: Атака Клонов",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Оценка IMDB": "6.6/10"
      }
    ],
    "Аук (с модами)": [
      { "id": 1, "название": "Реролл | Minecraft", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 2, "название": "Сплит | 5 игр", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 3, "название": "Реролл | Ace Attorney", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 4, "название": "Реролл | Orwell", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 5, "название": "Сплит | 5 игр", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 6, "название": "Демокр | TF 2", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 7, "название": "Реролл | 5D шахматы (краска)", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 8, "название": "Абсурдный | Рисовать картину", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 9, "название": "Царь Горы | Cities Skylines 2", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 10, "название": "Абсурдный | Скайрим + Куплинов ЛП", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 11, "название": "Сплит | 5 игр", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 12, "название": "Абсурдный | Чтение Игры Престолов", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 13, "название": "Сплит | 5 игр", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 14, "название": "Реактивный", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 15, "название": "Сплит | 5 игр", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 16, "название": "Абсурдный | Думерский", "просмотр": "Просмотреть", "оценка": "0/10" },
      { "id": 17, "название": "Прикольный | Baldur's Gate 3", "просмотр": "Просмотреть", "оценка": "0/10" }
    ],
    Аниме: [
      {
        "Аукцион": "Аниме",
        "номер": 1,
        "название": "Город в котором меня нет",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Рейтинг MAL": "8.28/10"
      },
      {
        "Аукцион": "Аниме",
        "номер": 2,
        "название": "Руки прочь от кинокружка",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Рейтинг MAL": "8.16/10"
      },
      {
        "Аукцион": "Аниме",
        "номер": 3,
        "название": "Обещанный Неверленд",
        "просмотр": "Отсутствует",
        "оценка стримера": "Неизвестно",
        "Рейтинг MAL": "8.49/10"
      }
    ],
};
const fakeApi = {
  Кино: () => new Promise(resolve => setTimeout(() => resolve(fakeApiDatabase.Кино), 0)),
  Игры: () => new Promise(resolve => setTimeout(() => resolve(fakeApiDatabase.Игры), 0)),
  Аниме: () => new Promise(resolve => setTimeout(() => resolve(fakeApiDatabase.Аниме), 0)), // Передаем саму функцию
};

// --- STATE (без изменений) ---
const searchQuery = ref('');
const data = ref([]);
const loading = ref(false);
const error = ref(null);
const activeType = ref(Object.keys(fakeApi)[0]);
const fuseOptions = {
  keys: ['название'], // По каким ключам искать
  threshold: 0.4,
};
let fuse = new Fuse(data.value, fuseOptions);


// --- LOGIC (без изменений) ---
async function fetchData() {
  // loading.value = true;
  error.value = null;
  const apiMethod = fakeApi[activeType.value];
  if (typeof apiMethod !== 'function') { /* ...защитный код... */ return; }
  try {
    data.value = await apiMethod();
    fuse = new Fuse(data.value, fuseOptions);
  } catch (e) {
    error.value = e; data.value = [];
  } finally {
    loading.value = false;
  }
}
function changeType(typeKey) {
  activeType.value = typeKey;
  searchQuery.value = '';
  fetchData();
}
onMounted(() => { fetchData(); });

// --- COMPUTED PROPERTIES ---
// Логика фильтрации остается прежней - она идеальна

const filteredList = computed(() => {
  if (!searchQuery.value) {
    return data.value; // Если поиск пуст, показываем все
  }

  let list;
  list = fuse.search(searchQuery.value).map(result => result.item);
  console.log(filteredList);
  return list
});

// НОВОЕ: Динамически получаем заголовки таблицы
const tableHeaders = computed(() => {
  // Если данных нет, возвращаем пустой массив
  if (data.value.length === 0) return [];
  // Берем ключи из ПЕРВОГО объекта в массиве
  return Object.keys(data.value[0]);
});
</script>

<style scoped>
/* Общие стили и стили для поиска/типов/состояний остаются прежними */
.main-container {
  max-width: 800px;
  margin: 2rem auto;
  font-family: sans-serif;
  border-radius: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  padding: 1.5rem 2rem;
}
.search input {
  width: 100%;
  padding: 0.75rem 1rem;
  font-size: 1rem;
  border-radius: 8px;
  color: var(--text-color);
  border: 1px solid var(--border-color);
  background-color: var(--border-color);
}
.search input:focus {
  outline: 1px solid #3a3a3a;
}
.type {
  display: flex;
  gap: 0.5rem;
  margin: 1rem 0;
  padding-bottom: 1rem;
}
.type-btn {
  padding: 0.5rem 1rem;
  border: none;
  color: var(--text-secondary-color);
  border-radius: 8px;
  background-color: var(--border-color);
  cursor: pointer;
  font-weight: 500;
  text-transform: capitalize;
}
.type-btn:hover {
  background-color: var(--border-color-dark);
}
.type-btn.active {
  color: var(--text-color);
}
.state-indicator {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem 1rem;
  color: #888;
}
.error-state {
  color: #d9534f;
}
.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #007aff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 1rem;
}
@keyframes spin {
  0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); }
}

.table-container {
  overflow-x: auto; /* Добавляем горизонтальный скролл, если таблица не помещается */
}
table {
  width: 100%;
  border-spacing: 0 10px;
  text-align: center;
  font-size: 0.9rem;
}
th, td {
  padding: 0.75rem 1rem;
}
thead {
  background-color: var(--border-color);
  border-bottom: 10px solid var(--background-color);
}
th {
  font-weight: 600;
  color: var(--text-color);
  text-transform: capitalize; /* Делаем первую букву заголовка заглавной */
}
tbody tr:hover {
  background-color: var(--border-color); /* Подсветка строки при наведении */
}
.empty-state {
  text-align: center;
  padding: 3rem 1rem;
  color: #888;
}

.state-indicator {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem 1rem;
  color: #888;
}
.error-state {
  color: #d9534f;
}
.error-message {
  font-family: monospace;
  background: rgba(217, 83, 79, 0.1);
  padding: 0.5rem;
  border-radius: 6px;
  margin-top: 0.5rem;
  margin-bottom: 1rem;
}
.retry-btn {
  padding: 0.5rem 1.5rem;
  border: 1px solid #ccc;
  border-radius: 8px;
  background-color: #f0f0f0;
  cursor: pointer;
  transition: background-color 0.2s;
}
.retry-btn:hover {
  background-color: #e0e0e0;
}


/* Сообщение об отсутствии результатов */
.empty-state {
  text-align: center;
  padding: 3rem 1rem;
  color: #888;
}

thead th:first-child {
  border-top-left-radius: 10px;
  border-bottom-left-radius: 10px;
}
thead th:last-child {
  border-top-right-radius: 10px;
  border-bottom-right-radius: 10px;
}
tbody td:first-child {
  border-top-left-radius: 10px;
  border-bottom-left-radius: 10px;
}
tbody td:last-child {
  border-top-right-radius: 10px;
  border-bottom-right-radius: 10px;
}
.search {
  display: flex;
}
.description {
  text-align: center;
  font-size: 0.9rem;
  margin-bottom: 1rem
}

.quote {
  display: flex;
  flex-direction: row;
  font-size: 0.9rem;
  width: fit-content;
  margin: 0 auto;
  background-color: var(--dark-sm);
  padding: 0 0.7em;
  border-radius: var(--border-radius-md);
  border: 1px solid var(--border-color);
}

.quote p{
  align-content: center;
  margin-left: 0.7em;
  margin-right: 0.5em;
}

.quote-left {
  padding: 0.5em 1.03em;
  margin: 0.7em 0;
  background-color: rgba(255, 0, 0, 0.25);
  border-radius: var(--border-radius-sm);
}

.quote-left i {
  font-weight: 800;
  font-size: 1rem;
  color: rgb(255, 0, 0);
}

.list-enter-active,
.list-leave-active,
.list-move {
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.list-enter-from,
.list-leave-to {
  opacity: 0;
  transform: translateY(20px);
}



/* 2. Анимация для плавной смены состояний (загрузка -> таблица) */
.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.3s ease;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}

@media (max-width: 768px) {

  /* Адаптируем верхний блок с цитатой */
  .description .quote {
    align-items: center;
    text-align: center;
  }

  .description .quote p {
    margin: 0;
    margin-left: 0.7em;
  }
}
</style>